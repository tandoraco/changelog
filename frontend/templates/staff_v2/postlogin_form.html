{% extends "staff_v2/base.html" %}
{% load crispy_forms_tags %}
{% block content %}
<div class="main-wrapper">
    {% include 'staff_v2/menu_postlogin.html' %}
    <section class="section-wrapper signin-page">
        <center>{% if extra %}
                <h3>{{ extra|safe }}</h3>
            {% endif %}</center>
        {% if form %}
        <div class="container">
            <div class="row align-center">
                <div class="col-12 col-sm-12 col-md-12 col-lg-6">
                    <div class="title">
                        <h2>{{ action_name }} <br><span>{{ model_name }}</span></h2>
                        <!--p>Lorem Ipsum is simply dummy text of <br>the printing</p-->
                    </div>
                </div>
                <div class="col-12 col-sm-12 col-md-12 col-lg-6">
                    <div class="signin-form">
                        <div class="account-content">
                            <form class="form" method="post" action=""
                                {% if is_multipart_form %}
                                    enctype='multipart/form-data'
                                {% endif %}
                            >
                                {% csrf_token %}
                                {{ form|crispy }}
                                <div class="theme-button">
                                    <button type="submit" class="submit-btn">Submit</button>
                                    <button type="reset" class="submit-btn reset-btn">Reset</button>
                                </div>
                            </form>
                        </div>
                        <br>
                        <div class="theme-button">
                            <div id="extra_actions">
                            </div>
                        </div>
                        <div id="notification_toast"></div>
                    </div>
                </div>
            </div>
        </div>
        {% endif %}
    </section>
</div>
<script>
    let categoryDiv = document.getElementById('div_id_category');
    if(categoryDiv) {
        categoryDiv.classList.add('dropdown_box');
    }
    let publishDiv = document.getElementById('div_id_published');
    if(publishDiv) {
        publishDiv.classList.add('inputWithIcon')
        publishDiv.classList.add('inputIconBg');
    }
    let zapierDiv = document.getElementById('div_id_zapier_trigger_scenario');
    if(zapierDiv) {
        zapierDiv.classList.add('dropdown_box');
    }
    let enabledDiv = document.getElementById('  id_enabled');
    if(enabledDiv) {
        enabledDiv.classList.add('inputWithIcon')
        enabledDiv.classList.add('inputIconBg');
    }
</script>
<script>
        let apiKey = document.getElementById('id_api_key');
        let extraActions = document.getElementById('extra_actions');
        if(apiKey && window.location.href.indexOf('/staff/manage/integrations') > 0) {
            function copyApiKey() {
                apiKey.select()
                apiKey.setSelectionRange(0, 99999);
                document.execCommand("copy");
                showToast('success', 'Api key is copied to clipboard', '');
            }
            let copyApiKeyButton = document.createElement('button');
            copyApiKeyButton.classList.add('btn');
            copyApiKeyButton.classList.add('btn-dark');
            copyApiKeyButton.innerHTML = 'Copy Api key';
            copyApiKeyButton.onclick = copyApiKey;
            extraActions.appendChild(copyApiKeyButton);
        }
</script>
<script>
        // Logo validation error is not shown; On inspecting, it's display was set to none;
        // In order to ensure, we do not miss out any validation errors, getting all error messages
        // and if their display is none, we are enabling it's display.
        errorElements = document.getElementsByClassName('invalid-feedback');
        for(i=0; i<errorElements.length; i++) {
            errorElements[i].style.display = 'block';
        }
</script>
<script>
        if(window.location.href.indexOf('staff/manage/pinned-changelog') > 0) {
            let changelogDiv = document.getElementById('div_id_changelog');
            if(changelogDiv) {
                changelogDiv.classList.add('dropdown_box');
            }
        }
</script>
{% endblock %}